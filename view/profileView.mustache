<style>
    .profile-image, .profile-qr {
        width: 80px; height: 80px; object-fit: cover;
    }
    @media (min-width: 768px) {
        .profile-image, .profile-qr {
            width: 128px; height: 128px;
        }
    }
</style>

<section class="py-5 min-vh-100" style="background: url('../../QuizGame/public/img/background.png'); background-size: cover; background-position: center;">
    <div class="container my-4">
        <div class="bg-white bg-opacity-75 shadow-lg rounded-4 p-3 p-md-4">
            {{#user}}
            <div class="row align-items-center mb-4 text-center text-md-start gy-3">
                <div class="col-12 col-md-4">
                    <p class="mb-1 fw-bold fs-5">Usuario: {{usuario}}</p>
                    <small class="fs-6 text-muted">{{año_nacimiento}} - {{sexo}}</small>
                </div>
                <div class="col-12 col-md-5">
                    <p class="fw-bold mb-1 fs-5">{{nombre_completo}}</p>
                    <p class="mb-1 fs-6 text-muted">{{mail}}</p>
                    <small class="fs-6 text-muted">{{ciudad}}, {{pais}}</small>
                </div>
                <div class="col-12 col-md-3 d-flex justify-content-center justify-content-md-end align-items-center gap-3">
                    <img src='/QuizGame/profile/generateQR?username={{usuario}}' class="profile-qr" alt='QR de {{usuario}}'>
                    {{#foto_perfil}}
                        <img src="/QuizGame/public/uploads/{{foto_perfil}}" alt="Foto de perfil" class="rounded-circle profile-image">
                    {{/foto_perfil}}
                    {{^foto_perfil}}
                        <i class="fa fa-user-circle text-secondary profile-image" style="font-size: 128px;"></i>
                    {{/foto_perfil}}
                </div>
            </div>
            {{/user}}

            <div class="row gy-4">
                {{#es_jugador}}
                <div class="col-12 col-lg-6">
                    <h5 class="fw-bold mb-3 fs-4">Partidas recientes</h5>
                    <div class="d-grid gap-3">
                        {{#partidas}}
                            <div class="card shadow-sm">
                                <div class="card-body p-3">
                                    <div class="row align-items-center text-center gy-2">
                                        <div class="col-12 col-sm-3 col-md-2"><img src="../../QuizGame/public/img/icono_preguntas.png" alt="partida" style="height: 40px;"></div>
                                        <div class="col-4 col-sm-3 col-md-3"><div class="text-muted small">Correctas</div><div class="fw-bold">{{cantidad_correctas}}</div></div>
                                        <div class="col-4 col-sm-3 col-md-3"><div class="text-muted small">Puntaje</div><div class="fw-bold">{{puntaje}}</div></div>
                                        <div class="col-4 col-sm-3 col-md-4"><div class="text-muted small">Destacado</div>
                                            {{#nombre_categoria}}<span class="badge text-capitalize" style="background-color: {{color_categoria}};">{{nombre_categoria}}</span>{{/nombre_categoria}}
                                            {{^nombre_categoria}}<span class="badge bg-secondary">N/A</span>{{/nombre_categoria}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {{/partidas}}
                        {{^partidas}}<div class="alert alert-info">No tenés partidas recientes.</div>{{/partidas}}
                    </div>
                </div>
                {{/es_jugador}}
                <div class="col-12 {{#es_jugador}}col-lg-6{{/es_jugador}}{{^es_jugador}}col-lg-12{{/es_jugador}}">
                    {{#es_jugador}}<h5 class="fw-bold mb-3 fs-4">Tu ubicación</h5>{{/es_jugador}}
                    {{#user}}
                        <div id="map-profile" data-lat="{{latitud}}" data-lng="{{longitud}}" class="w-100 rounded-4 shadow-sm" style="min-height: 300px;"></div>
                    {{/user}}
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="/QuizGame/public/js/profile.js" defer></script>